\section{Maximal Equicontinuous Factor}
\begin{theorem}[Maximal equicontinuous factor]
  Let $(X,T)$ be a TDS.
  Then $(X,T)$ has a unique (up to equivalence) equicontinuous factor $\pi : (X,T) \to (A,T)$ that is maximal in the following sense:
  Let $R$ be the ICER generated by $\pi$.
  If $\varphi : (X,T) \to (Y,T)$ is another equicontinuous factor and $R_\varphi$ the ICER generated by $\varphi$, then $R \subset R_\varphi$.
  This factor is called the \emph{maximal equicontinuous factor} (MEF).
\end{theorem}
\begin{proof}
  Existence:
  Let
  \begin{equation*}
    \mathcal{R} := \{ R \subset X \times X : R \ \text{ICER with} \ X/R \ \text{equicontinuous}\}.
  \end{equation*}
  Then $ X \times X \in \mathcal{R}$ and so $\mathcal{R} \neq \varnothing$.
    Now let 
  \begin{equation*}
    R:= \cap \mathcal{R}.
  \end{equation*}
  Then $R$ is an ICER (because intersection of ICERs are ICERs).
  If $\varphi : (X,T)\to (Y,T)$ is a factor with $(Y,T)$ equicontinuous and $R_\varphi$ the ICER generated by $\varphi$. Then $(X/R_\varphi,T)$ is conjugate to $(Y,T)$ by \cref{prop:factorsAndIcers}.
  And so $(X/R_\varphi,T)$ is equicontinuous, because equicontinuity is conjugation invariant (\cref{prop:equiContConjugationInvariance}).
  Therefore $R \subset R_\varphi$ and so $R$ is the maximal ICER in the sense of the theorem.\\
  It is left to show, that $R$ is the ICER generated by an equicontinuous factor:
  By metrizability there exists a family $(R_n)_{n\in\mathbb{N}}$ of elements of $\mathcal{R}$ with
  $R = \cap_{n=1}^\infty R_n$ {\color{red} do lemma}.
  The product system $(\prod_{n=1}^\infty X/R_n,T)$ is equicontinuous, since products of equicontinuous systems are equicontinuous (\cref{prop:productsOfEquiContAreEquiCont}).
  Consider the morphism $f:= X \ni x  \mapsto ([x]_{R_n})_{n \in \mathbb{N}}$.
  Let $A:= f(X)$, then $A$ is $T$-invariant being the image of a morphism.
  Furthermore $A$ is compact by continuity of $f$ and compactness of $X$.
  Since $A$ is a compact subset of a Hausdorff space it follows that $A$ is closed.
  Therefore we can consider the subsystem $(A,T)$ which is an equicontinuous system because subsystems of equicontinuous systems are equicontinuous (\cref{prop:SubsystemOfEquiContIsEquiCont}).
  Consider the map $\pi: X \to  A , \  x  \mapsto ([x]_{R_n})_{n \in \mathbb{N}}$.
  Then $\pi$ is a factor and the ICER generated by $\pi$ is equal to $R$, because: $\forall x_1,x_2 \in X$:
  \begin{equation*}
    \pi(x_1) = \pi (x_2) \Leftrightarrow ([x_1]_{R_n})_{n\in \mathbb{N}} = ([x_2]_{R_n})_{n\in \mathbb{N}}
    \Leftrightarrow \forall n \in \mathbb{N} : (x_1, x_2 ) \in R_n
    \Leftrightarrow (x_1,x_2) \in \cap_{n=1}^\infty R_n = R.
  \end{equation*}
  Therefore $\pi$ is a maximal equicontinuous factor.\\
  Uniqueness:
  If $\varphi$ is another maximal equicontinuous factor and $R_\varphi$ the ICER generated by it, then $R \subset R_\varphi$ as was shown above.
  By maximality of $\varphi$: $R_\varphi \subset R$ and so $R_\varphi = R$.
\end{proof}

\begin{proposition}[Universal Property of the MEF]
  Let $(X,T)$ be a TDS. Let $\pi : (X, T) \to  (X_m,T)$ be the MEF.
  Then for every equicontinuous factor $\varphi : (X,T) \to (Y,T)$ there exists a unique factor $\tilde{\varphi}: (X/R,T) \to (Y,T)$ with $\varphi = \tilde{\varphi} \circ \pi$.
\end{proposition}
\begin{proof}
  Let $R$ be the ICER generated by $\pi$.
  Wlog $X_m = X/R$ and $\pi$ is the quotient map.
  Let $(x_1, x_2) \in R$. Then $\varphi (x_1) = \varphi (x_2)$, because $R$ is contained in the ICER generated by $\varphi$.
  The universal property of the quotient topology implies that there exists a unique continuous map $\tilde{\varphi}: X/R \to Y$ with $\varphi = \tilde{\varphi}\circ \pi$.
  It is left to show that $\tilde{\varphi}$ is a factor.
  Clearly $\tilde{\varphi}$ is surjective and for all $t\in T$ and $x \in X$:
  \begin{equation*}
    t \tilde{\varphi} (\pi(x)) =  t \varphi (x) = \varphi (tx) = \tilde{\varphi}(\pi (tx)) = \tilde{\varphi}(t \pi (x)) .
  \end{equation*}
  Showing that $\tilde{\varphi}$ is a homomorphism.
\end{proof}
\subsection{Computing the MEF}
In this section let $(X,T)$ be a TDS with $T$ abelian.
We denote by $T^*$ the set of all characters.
\begin{definition}[Koopman operator]
  The \emph{Koopman operator} $U : T \to L(C(X))$ of $(X,T)$ is defined by $(U(t) f)(x) := f(t^{-1}x)$.
  $0 \neq f \in C(X)$ is called an \emph{eigenfunction} (of $U$) to \emph{eigenvalue} $\chi \in T^*$ if $f \in \ker (U-\chi):= \bigcap_{t \in T} \ker (U(t)- \chi (t)I)$.
\end{definition}
\begin{definition}[Discrete spectrum]
  The TDS $(X,T)$ has \emph{discrete spectrum} $:\Leftrightarrow $ $C(X) = \overline{\lin} \bigcup_{\chi \in T^*} \ker (U- \chi)$.
\end{definition}

\begin{theorem}
  \label{mef:thm:equiEQdiscrete}
  $(X,T)$ is equicontinuous $\Leftrightarrow$ $(X,T)$ has discrete spectrum.
\end{theorem}
\begin{proof}
  ISEM lecture notes CH 15 + Auslander.
\end{proof}

\begin{theorem}[MEF eigenfunction characterisation]
  \label{thm:MEF_EFchar}
  Let $x_1,x_2 \in X$. Let $\pi : (X,T) \to (X/R,T)$ be the MEF.
  Then
  \begin{equation*}
  \pi (x_1) = \pi (x_2) \Leftrightarrow 
    \forall f \in \bigcup_{\chi \in T^*} \ker (U- \chi) : f(x_1) = f(x_2).
  \end{equation*}
\end{theorem}
\begin{proof}
  To \enquote{$\Rightarrow$}:
  Let $f \in \bigcup_{\chi \in T^*} \ker (U- \chi)$ be an eigenfunction and $\chi$ the corresponding eigenvalue.  Then for all $t \in T, x \in X$:
  \begin{equation*}
    t f(x) = \chi (-t) f (x) = (U(-t) f)(x) = f(tx).
  \end{equation*}
  Therefore $f: (X,T) \to (f(X),T)$ is an equicontinuous factor, where the action of $t \in T$ on $f(X)$ is given by multiplication with $\chi(-t)$.
  By the universal property of the MEF there exists a continuous $\tilde{f}  : X/R  \to \mathbb{C}$ with $\tilde{f} \circ \pi = f$.
  Therefore $f(x_1) = \tilde{f} (\pi (x_1) )=  \tilde{f} ( \pi (x_2)) = f (x_2)$.\\
  To \enquote{$\Leftarrow$}:
  Assume $\pi (x_1) \neq \pi (x_2)$.
  Then there exists an eigenfunction $h \in C(X/R)$ of $(X/R,T)$ with $h (\pi(x_1)) \neq h(\pi (x_2))$.
  Assume otherwise: Then by theorem \ref{mef:thm:equiEQdiscrete} $g (\pi (x_1)) = g(\pi (x_2))$ for every $g \in C(X/R)$ contradicting the Hausdorffness of $X/R$.
  Now $f:= h \circ \pi$ is an eigenfunction of $(X,T)$ with $f(x_1) \neq f(x_2)$ contradicting the assumption.
\end{proof}

\begin{proposition}[MEF of skew rotation]
Let $a \in \mathbb{T}$ and $\alpha: \mathbb{T}^2 \to \mathbb{T}^2,$ $\alpha (x,y) := (ax,xy)$.
  Consider the TDS $(\mathbb{Z}, \mathbb{T}^2)$ with the $\mathbb{Z}$-action defined by $t (x,y) := \alpha^t (x,y)$.
  Then the MEF is given by $\pr_1 : (\mathbb{T}^2,\mathbb{Z}) \to (\mathbb{T},\mathbb{Z}), \pr_1 (x,y) := x$, where the $\mathbb{Z}$-action on $\mathbb{T}$ is defined by $t x \mapsto a^t x$.
\end{proposition}
\begin{proof}
  Well definedness of the TDS:
  Clearly $\mathbb{T}^2$ is a compact metric space and $\mathbb{Z}$ a topological group.
  $\alpha$ is a homeomorphism with inverse $\alpha^{-1} (x,y):= (a^{-1} x, a x^{-1} y)$.
  This shows the well-definedness of the $T$-action.
  The continuity of the $T$-action follows from continuity of $\alpha$ and $\alpha^{-1}$ together with the fact that $\mathbb{Z}$ carries the discrete topology.
  We want to apply \cref{thm:MEF_EFchar}.
  Let $\pi : (\mathbb{T}^2 , \mathbb{Z}) \to (\mathbb{T}^2/R, \mathbb{Z})$ be the MEF.
  Let $(x_1, y_1), (x_2, y_2) \in \mathbb{T}^2$.
  If $x_1 \neq x_2$, then $\pr_1$ is an eigenfunctions to eigenvalue $t \mapsto a^{-t}$ that takes different values on $x_1$ and $x_2$ and so $\pi(x_1) \neq \pi(x_2)$.
  Assume $x_1 = x_2$.
  Let $f \in C(\mathbb{T}^2)$ be an eigenfunction with eigenvalue $\chi$.
  The goal is to show $f(x_1, y_1) = f(x_2,y_2)$.
  Let $\lambda := \chi (-1)$.
  We consider $f$ as an element of $L^2( \mathbb{T}^2)$.
  Let $(e_n)_{n \in \mathbb{Z}}$, \ $e_n(x):= x^n$ be the monomials on $\mathbb{T}$.
  They form an orthonormal basis of $L^2(\mathbb{T})$ and so $(e_n \otimes e_m)_{(n,m) \in \mathbb{Z}^2}$ is an orthonormal basis of $L^2(\mathbb{T}^2)$.
  Therefore (in $L^2$)
  \begin{equation*}
    f = \sum_{(n,m) \in \mathbb{Z}^2} \langle f, e_n \otimes e_m \rangle e_n \otimes e_m.
  \end{equation*}
  Furthermore $\alpha$ and $\alpha^{-1}$ preserve the Haar measure of $\mathbb{T}^2$ therefore we can lift the eigenvalue equation to $L^2$:
  \begin{equation}
    \label{eq:T2mefEveq}
    \lambda f = \chi(-1) f=  U(-1)f  = f \circ \alpha.
  \end{equation}
  Now for $(n,m) \in \mathbb{Z}^2$ and $(x,y) \in \mathbb{T}^2$:
  \begin{equation*}
    e_n \otimes e_m (\alpha (x,y)) = e_n \otimes e_m (a x, x y) = (ax)^n (xy)^m = a^n x^{m+n} y^m
    = a^n e_{m+n} \otimes e_m (x,y).
  \end{equation*}
  Therefore \cref{eq:T2mefEveq} equivalent to $\forall (n,m) \in \mathbb{Z}^2$:
  \begin{equation*}
    \sum_{(n,m) \in \mathbb{Z}^2} \lambda \langle f, e_n \otimes e_m \rangle e_n \otimes e_m = 
    \sum_{(n,m) \in \mathbb{Z}^2} a^n \langle f, e_n \otimes e_m \rangle e_{n+m} \otimes e_m.
  \end{equation*}
  Which implies that
$\forall (n,m) \in \mathbb{Z}^2$:
\begin{equation*}
  |\langle f, e_{n+m} \otimes e_m \rangle|  = |\langle f, e_n \otimes e_m \rangle|.
\end{equation*}
  Fix $m \in \mathbb{Z} \setminus \{0\}$.
  We want to show that $\forall n \in \mathbb{Z}: |\langle f, e_n \otimes e_m \rangle| = 0$.
  Let $n \in \mathbb{Z}$ with $|\langle f, e_n \otimes e_m \rangle| > 0$.
  Then for all $k \in \mathbb{N}: |\langle f, e_{n+km} \otimes e_m \rangle| = |\langle f, e_n \otimes e_m \rangle|>0$.
  Then
  \begin{equation*}
    \infty = \sum_{k \in \mathbb{N} } |\langle f, e_{n+km} \otimes e_m \rangle|^2
    \leq   \sum_{(n,m) \in \mathbb{Z}^2} |\langle f, e_{n} \otimes e_m \rangle|^2 
    =\|f\|_{L^2} < \infty.
  \end{equation*}
  A contradiction.
  In total
  \begin{equation*}
    f = \sum_{n \in \mathbb{Z}} \langle f, e_n \otimes e_0 \rangle e_n \otimes e_0.
  \end{equation*}
  Therefore there is $h \in L^2(\mathbb{T})$ and a nullset $N \subset \mathbb{T}^2$ so that for all $(x,y) \in \mathbb{T}^2 \setminus N : f(x,y) = h(x)$.
  Therefore for all  $(x,y) , (x,y^\prime) \in \mathbb{T}^2 \setminus N , f(x,y) = f(x,y^\prime)$. 
  By continuity of $f$ (and a small null-set argument) this implies that $\forall (x,y), (x,y^\prime) \in \mathbb{T}^2 : f(x,y) = f(x,y^\prime)$.
  In particular this shows, that $f(x_1,y_1) = f(x_2, y_2)$ since $x_1 = x_2$.
\end{proof}
